(function(){var $container,haveInitialized,newElems=[],indexKey="__knockout-isotope-index",filterClass,itemClass,isotopeOptions;function beforeAdd(node,index,item,isInitializing){var $elem;if(node.nodeType!==1){return}$elem=$(node);if(isInitializing!==true){$elem.removeClass(filterClass);newElems.push(node);$container.isotope("addItems",$elem);$container.isotope()}$elem.data(indexKey,index)}function afterMove(node,index,item){var $elem;if(node.nodeType!==1){return}$elem=$(node);$elem.data(indexKey,index)}function beforeRemove(node,index,item){if(node.nodeType!==1){return}$container.isotope("remove",$(node))}ko.bindingHandlers.isotope={defaultFilterClass:"knockout-isotope-filter",defaultItemClass:"knockout-isotope-item",_getSortData:function($elem){return $elem.data(indexKey)},makeTemplateValueAccessor:function(valueAccessor){return function(){var modelValue=valueAccessor(),unwrappedValue=ko.utils.peekObservable(modelValue);options={beforeAdd:beforeAdd,afterMove:afterMove,beforeRemove:beforeRemove};if(!unwrappedValue||typeof unwrappedValue.length==="number"){ko.utils.extend(options,{foreach:modelValue,templateEngine:ko.nativeTemplateEngine.instance});return options}ko.utils.unwrapObservable(modelValue);ko.utils.extend(options,{foreach:unwrappedValue.data,as:unwrappedValue.as,includeDestroyed:unwrappedValue.includeDestroyed,templateEngine:ko.nativeTemplateEngine.instance});return options}},init:function(element,valueAccessor,allBindingsAccessor,viewModel,bindingContext){var parameters;filterClass=ko.bindingHandlers.isotope.defaultFilterClass;itemClass=ko.bindingHandlers.isotope.defaultItemClass;isotopeOptions={};haveInitialized=false;$container=$(element);if($container.children().length!==1){throw new Error("The element must have *1* child, from to instantiate Isotope items")}parameters=ko.utils.unwrapObservable(valueAccessor());if(parameters&&typeof parameters=="object"&&!("length"in parameters)){if(parameters.options){var clientOptions=parameters.options();if(typeof clientOptions!=="object"){throw new Error("isotopeOptions callback must return object")}ko.utils.extend(isotopeOptions,clientOptions)}if(parameters.filterClass){filterClass=parameters.filterClass}if(parameters.itemClass){itemClass=parameters.itemClass}}$container.children().addClass(itemClass).addClass(filterClass);ko.bindingHandlers.template.init(element,ko.bindingHandlers.isotope.makeTemplateValueAccessor(valueAccessor));return{controlsDescendantBindings:true}},update:function(element,valueAccessor,allBindingsAccessor,viewModel,bindingContext){ko.bindingHandlers.template.update(element,ko.bindingHandlers.isotope.makeTemplateValueAccessor(valueAccessor),allBindingsAccessor,viewModel,bindingContext);if(!haveInitialized){isotopeOptions.itemSelector="."+itemClass;isotopeOptions.filter="."+filterClass;isotopeOptions.getSortData={index:ko.bindingHandlers.isotope._getSortData};isotopeOptions.sortBy="index";$container.isotope(isotopeOptions)}else{$container.isotope("reSort");$(newElems).addClass(filterClass);newElems.splice(0,newElems.length);$container.isotope()}var data=ko.bindingHandlers.isotope.makeTemplateValueAccessor(valueAccessor)().foreach;ko.utils.unwrapObservable(data);haveInitialized=true;return{controlsDescendantBindings:true}}}})();